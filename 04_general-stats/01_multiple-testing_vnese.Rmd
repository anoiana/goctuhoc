---
title: "ğŸ“ Multiple Hypothesis Testing"
author: ğŸ‘¦ $\mathcal{A.T}$
date: "ğŸ“… `r format(Sys.Date(), format = '%B %d, %Y')`"
header-includes:
   - \usepackage{amsmath}
   - \usepackage{titling}
   - \pretitle{\begin{flushleft}}
   - \posttitle{\end{flushleft}}
   - \usepackage{eso-pic,graphicx,transparent}
abstract: Trong clinical trials, ráº¥t thÆ°á»ng xuyÃªn ta pháº£i thá»±c hiá»‡n cÃ¹ng lÃºc nhiá»u kiá»ƒm Ä‘á»‹nh. Cá»© má»—i má»™t kiá»ƒm Ä‘á»‹nh cho phÃ©p kháº£ nÄƒng sai lÃªn Ä‘áº¿n $\alpha$ (thÆ°á»ng chá»n $\alpha =0.05$ hay $0.1$). NhÆ°ng náº¿u pháº£i thá»±c hiá»‡n cÃ¡c kiá»ƒm Ä‘á»‹nh cÃ¹ng vá»›i nhau,  viá»‡c xem xÃ©t vÃ  Ä‘Ã¡nh giÃ¡ tá»«ng kiá»ƒm Ä‘á»‹nh riÃªng láº» vá»›i má»©c Ä‘á»™ sai cháº¥p nháº­n cho má»—i kiá»ƒm Ä‘á»‹nh $\alpha$ thÃ¬ káº¿t quáº£ cuá»‘i cÃ¹ng khÃ´ng Ä‘Ã¡ng tin cáº­y. bÃ i nÃ y sáº½ Ä‘Æ°a ra cÃ¡c phÆ°Æ¡ng phÃ¡p giÃºp ta Ä‘iá»u chá»‰nh má»©c Ä‘á»™ sai $\alpha$ khi ta thá»±c hiá»‡n nhiá»u kiá»ƒm Ä‘á»‹nh cÃ¹ng lÃºc. 
output: 
    bookdown::html_document2:
      fig_caption: yes
      theme: readable
      highlight: tango
      toc: true
      toc_float: 
        collapsed: false
      toc_depth: 3
      code_folding: hide
      css: "../00_supp/style.css"
      number_sections: true
      includes:
        in_header: "../00_supp/header.html"
        before_body: "test.html"
fontsize: 12pt
bibliography: ["citation.bib"]
csl: "../00_supp/apa.csl"
link-citations: true
editor_options: 
  chunk_output_type: console
---

```{css, echo = F}
/*----------LOGO above TOC---------*/

#TOC::before {
  content: "";
  display: block;
  height: 200px;
  margin: 2.75em 20px 40px 20px;
  background-image: url("ht.png");
  background-size: contain;
  background-position: center center;
  background-repeat: no-repeat;
}
```


```{r child="../00_supp/general_rmd.Rmd"}
```

# Introduction 

Khi ta phÃ¢n tÃ­ch cÃ¡c genomic data, ráº¥t thÆ°á»ng xuyÃªn ta pháº£i thá»±c hiá»‡n nhiá»u kiá»ƒm Ä‘á»‹nh cÃ¹ng lÃºc cho tá»«ng gene, vÃ  thÆ°á»ng sá»‘ lÆ°á»£ng genes cáº§n Ä‘Æ°á»£c kiá»ƒm Ä‘á»‹nh lÃªn tá»›i hÃ ng nghÃ¬n. Trong trÆ°á»ng há»£p nÃ y, viá»‡c xem xÃ©t cÃ¡c kiá»ƒm Ä‘á»‹nh riÃªng láº» dÆ°á»ng nhÆ° khÃ´ng thá»a Ä‘Ã¡ng. Ta hÃ£y láº¥y má»™t vÃ­ dá»¥ Ä‘á»ƒ minh há»a cho váº¥n Ä‘á» nÃ y, giáº£ sá»­ ta Ä‘Æ°á»£c yÃªu cáº§u thá»±c hiá»‡n $m$ kiá»ƒm Ä‘á»‹nh. Má»—i má»™t kiá»ƒm Ä‘á»‹nh ta cÃ³ 2 káº¿t luáº­n, hoáº·c lÃ  "reject" hoáº·c lÃ  "fail to reject". NhÆ° váº­y ta cÃ³ thá»ƒ tÃ³m táº¯c cÃ¡c kháº£ nÄƒng xáº£y ra trong má»™t báº£n nhÆ° sau 

```{r  tab1, echo = F, results='asis', fig.cap="_contigency table of $m$ hypothesis test_"}
tibble(
  ` ` = c("$$H_o~~~true$$","$$H_o~~~false$$", "total"),
  `not significant` = c("U","T","m-R"),
  `significant` = c("V","S","R"),
  `  ` = c("$$m_o$$","$$m_1$$","m")
)%>% draw_table()
```

Náº¿u $V$ lÃ  sá»‘ kiá»ƒm Ä‘á»‹nh bá»‹ rejected sai (false positive hay lá»—i loáº¡i I), ta cÃ³ 

$$
\begin{split}
\P(V\ge 1) &= 1 - \P(V=0) \\
&= 1 - \prod_{i=1}^m\P(\text{"kiá»ƒm Ä‘á»‹nh thá»© i khÃ´ng bá»‹ lá»—i"}) \\
&= 1 - \prod_{i=1}^n(1-\alpha)\\
&= 1 - (1- \alpha)^m
\end{split}
$$
náº¿u ta chá»n $\alpha = 0.05$ vÃ  khi sá»‘ lÆ°á»£ng kiá»ƒm Ä‘á»‹nh tÄƒng dáº§n ta tháº¥y sá»± biáº¿n Ä‘á»•i cá»§a false positive nhÆ° trong hÃ¬nh 

```{r, echo=F}
tibble(m = seq(1,50, length.out = 10)%>% round())%>%
  mutate("$$P(V \\ge1)$$" = 1-(1-0.05)^m)%>%
  modify_at(.at = 2, anh$cp(~round(.,3)))%>%
  draw_table()

```

RÃµ rÃ ng, $m$ cÃ ng lá»›n thÃ¬ kháº£ nÄƒng phÃ¡t sinh false positive cÃ ng lá»›n, nghÄ©a lÃ  lá»—i loáº¡i I cÃ ng nhiá»u. NhÆ° váº­y, ta cáº§n pháº£i Ä‘iá»ƒu chá»‰nh sao cho kháº£ nÄƒng false positive trá»Ÿ vá» má»©c $\alpha$. NÃ³i cÃ¡ch khÃ¡c ta muá»‘n  

$$
\text{tá»‘c Ä‘á»™ lá»—i} = \P(\text{false rejection of }H_o) \le \alpha
$$
Biá»ƒu thá»©c trÃªn Ä‘Æ°á»£c gá»i lÃ  _family-wise error rate_. NhÆ° váº­y ta muá»‘n $FWER \le \alpha$.

CÃ³ khÃ¡ nhiá»u phÆ°Æ¡ng phÃ¡p giÃºp ta Ä‘iá»u chá»‰nh FWER, tuy nhiÃªn trong giá»›i háº¡n bÃ i nÃ y ta sáº½ lÃ m quen vá»›i 2 trong sá»‘ nhá»¯ng phÆ°Æ¡ng phÃ¡p Ä‘Æ°á»£c sá»­ dá»¥ng nhiá»u Ä‘á»ƒ Ä‘iá»u chá»‰nh FWER Ä‘Ã³ lÃ 

1. PhÆ°Æ¡ng phÃ¡p Single-step
2. PhÆ°Æ¡ng phÃ¡p Stepwise (bao gá»“m step-down vÃ  step-up)

# Sá»­ dá»¥ng Single-step Ä‘á»ƒ Ä‘iá»u chá»‰nh FWER

Hai phÆ°Æ¡ng phÃ¡p thuá»™c nhÃ³m Ä‘iá»u chá»‰nh nÃ y chÃ­nh lÃ  Dunn-Sidak vÃ  Bonferroni.

## Dunn-Sidak 

GiÃ  sá»­ $\alpha_i = \alpha_d$ cho tá»«ng kiá»ƒm Ä‘á»‹nh riÃªng láº», ta muá»‘n tÃ¬m $\alpha_i$ sao cho $FWER \approx \alpha$. Náº¿u ta cÃ³ 

$$
\alpha = 1-(1-\alpha_d)^m
$$

thÃ¬ 

$$
\alpha_d = 1- (1-\alpha)^{1/m}
$$

dá»… tháº¥y ráº±ng

$$
\P(V\ge1)  = 1-(1-\alpha_d)^m = 1 - [1- 1+(1-\alpha)^{1/m}]^{m} = \alpha
$$

## Bonferroni

Ta cÅ©ng giáº£ sá»­ ráº±ng cÃ³ $m$ kiá»ƒm Ä‘á»‹nh $H_{oi}$, má»—i kiá»ƒm Ä‘á»‹nh sáº½ bá»‹ loáº¡i khi $p_i\le \alpha/m$. NhÆ° váº­y, Bonferroni vÃ  Dunn-Sidak cÃ³ má»‘i quan há»‡ tuyáº¿n tÃ­nh (linearly) bá»Ÿi vÃ¬  

$$
\begin{split}
(1-\alpha)^{1/m} &\stackrel{taylor}{=} 1 - \frac{\alpha}{m} + \frac{(1/m)[(1/m) -1]}{2}\alpha^2+ \dots\\
& \approx 1- \frac{\alpha}{m}
\end{split}
$$

VÃ­ dá»¥ cho $m = 10, \alpha = 0.05$ ta tÃ­nh Ä‘Æ°á»£c $\alpha_d  = 0.0051162$ vÃ  $\alpha/m = 0.005$.

# Sá»­ dá»¥ng Stepwise Ä‘á»ƒ Ä‘iá»u chá»‰nh FWER

CÅ©ng cÃ³ 2 phÆ°Æ¡ng phÃ¡p thuá»™c nhÃ³m stepwise Ä‘Æ°á»£c xem xÃ©t lÃ  _Holm_ vÃ  _Hochberg_.

## PhÆ°Æ¡ng phÃ¡p Holm

LÆ°u Ã½ ráº±ng cáº£ Bonferroni vÃ  Dunn-Sidak chá»‰ táº­p trung Ä‘iá»u chá»‰nh $\alpha$ cho tá»«ng kiá»ƒm Ä‘á»‹nh Ä‘á»™c láº­p, vÃ¬ tháº¿ kháº£ nÄƒng phÃ¡t hiá»‡n false positive cá»§a 2 phÆ°Æ¡ng phÃ¡p nÃ y ráº¥t tháº¥p má»™t khi sá»‘ kiá»ƒm Ä‘á»‹nh tÄƒng dáº§n. Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y ta cÃ³ thá»ƒ sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p Holm. PhÆ°Æ¡ng phÃ¡p Holm giÃºp tÄƒng Ä‘á»™ nháº¡y trong viá»‡c phÃ¡t hiá»‡n false positive mÃ  váº«n giá»¯ nguyÃªn FWER. 

Láº¥y $\{p_i:i=1,\dots,m\}$ lÃ  p-value cá»§a cÃ¡c kiá»ƒm Ä‘á»‹nh ta cáº§n xem xÃ©t, má»—i cÃ¡i tÆ°Æ¡ng á»©ng vá»›i $H_{01},\dots,H_{0m}$. PhÆ°Æ¡ng phÃ¡p Holm sáº½ Ä‘Æ°á»£c tiáº¿n hÃ nh nhÆ° sau

1. Xáº¿p thá»© tá»± cÃ¡c p-values. Ta kÃ½ hiá»‡u $\{p_{(i)}:i=1,\dots,m\}$ lÃ  táº­p há»£p cÃ¡c p.values Ä‘Ã£ Ä‘Æ°á»£c xáº¿p thá»© tá»±.
2. Ta láº§n lÆ°á»£t kiá»ƒm Ä‘á»‹nh $p_{(1)}, p_{(2)}, \dots, p_{(m)}$ vá»›i $\frac{\alpha}{m}, \frac{\alpha}{m-1}, \dots,$ GiÃ¡ trá»‹ p-value nhá» thá»© $i$ sáº½ Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ vá»›i $\frac{\alpha}{m-i+1}$. QuÃ¡ trÃ¬nh nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n cho Ä‘áº¿n khi ta tÃ¬m Ä‘Æ°á»£c káº¿t quáº£ fail to reject Ä‘áº§u tiÃªn, nghÄ©a lÃ  $p_{(j)} > \frac{\alpha}{m-j+1}$.
3. Káº¿t luáº­n ráº±ng nhá»¯ng kiá»ƒm Ä‘á»‹nh trÆ°á»›c kiá»‡m Ä‘á»‹nh bá»‹ fail to reject Ä‘áº§u tiÃªn chÃ­nh lÃ  cÃ¡c kiá»ƒm Ä‘á»‹nh cÃ³ Ã½ nghÄ©a thá»‘ng kÃª, tá»« kiá»ƒm Ä‘á»‹nh hiá»‡n táº¡i trá»Ÿ vá» sau sáº½ khÃ´ng cÃ³ Ã½ nghÄ©a. 


VÃ­ dá»¥ ta xem xÃ©t p-value cá»§a 16 kiá»ƒm Ä‘á»‹nh nhÆ° hÃ¬nh 

```{r}
d = read.csv("p-val.csv")%>% 
  mutate(type = paste("outcome",1:n()))%>%
  rename(p = maic_p_val)

modify_if(d, is.numeric, round, digits = 3)%>%
  draw_table()
```

sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p Holm cho data trÃªn ta Ä‘Æ°á»£c 

```{r}
d%>%
  arrange(p)%>%
  mutate(holm = p*c(16:1) )%>%
  mutate(holm = ifelse(holm>1,1,holm))%>%
  filter(holm<=0.05)%>%
  modify_if(is.numeric, round, digits = 3)%>%
  draw_table()
```
ta reject 2 kiá»ƒm Ä‘á»‹nh 2 vÃ  12. 

NgoÃ i ra ta cÃ³ thá»ƒ dÃ¹ng hÃ m R cÃ³ sáºµn Ä‘á»ƒ Ä‘iá»u chá»‰nh cÃ¡c p.value

```{r}
d<-
reduce2(
  list("bonferroni","holm"),
  list("bonferroni","holm"), 
  function(x,y,z) mutate(x,  {{z}} :=  p.adjust(x$p,y) ),
  .init = d)%>%
  arrange(p)

draw_table(modify_if(d,is.numeric,round,digits = 3))
```

ta thu Ä‘Æ°á»£c káº¿t quáº£ tÆ°Æ¡ng tá»±. 

NgoÃ i ra ta cÅ©ng cÃ³ thá»ƒ váº½ biá»ƒu Ä‘á»“ Ä‘á»ƒ minh há»a cho káº¿t quáº£ báº±ng cÃ¡ch 

- xáº¿p cÃ¡c p.value theo thá»© tá»± tÄƒng dáº§n.
- váº½ biá»ƒu Ä‘á»“ Ä‘iá»ƒm vá»›i trá»¥c ox lÃ  $1/(m-j+1)$ vÃ  oy lÃ  cÃ¡c p.value. 
- Váº½ Ä‘Æ°á»ng tháº³ng Ä‘i qua giao Ä‘iá»ƒm O vÃ  cÃ³ giÃ¡ trá»‹ slope lÃ  $\alpha$.

```{r}
d.g<-
d%>%
  mutate(frac = 1/(n() - rank(p)+1))%>%
  mutate(adj.p = ifelse(1/frac*p>=1,1,p/frac))%>%
  mutate(decision = ifelse(p<0.05*frac,"reject"," fail to reject"))%>%
  arrange(p)


ggplot(d.g, aes(x = frac,y = p, color = decision))+
  geom_point()+
  geom_abline(slope = 0.05, intercept = 0)
```

Ta tháº¥y ráº±ng cÃ¡c p-value náº±m bÃªn dÆ°á»›i Ä‘Æ°á»ng tháº±ng chÃ­nh lÃ  cÃ¡c kiá»ƒm Ä‘á»‹nh cÃ³ Ã½ nghÄ©a thá»‘ng kÃª. 

NgoÃ i ra ta cÃ³ thá»ƒ chá»©ng minh Ä‘Æ°á»£c ráº±ng phÆ°Æ¡ng phÃ¡p Holm thá»a mÃ£n Ä‘iá»u kiá»‡n $FWER \le \alpha$. Náº¿u $V$ lÃ  sá»‘ reject bá»‹ sai, ta sá»­ dá»¥ng báº¥t Ä‘áº³ng thá»©c Markovs vÃ  Ä‘Æ°á»£c káº¿t quáº£ nhÆ° sau

$$
\begin{split}
\P(V\ge1) \le \E(V) &= \E\big[\sum_{i \in m_0}\I(p_i \le \alpha/m) \big] \\
&= \sum_{i \in m_0}\P(p_i \le \alpha/m) \\
&\le \sum_{i \in m_0}\frac{\alpha}{m}\\
&= \frac{\alpha}{m}m_0 \\
& \le \frac{\alpha}{m}m = \alpha
\end{split}
$$

## Hochberg Procedure

PhÆ°Æ¡ng phÃ¡p nÃ y Ä‘Æ°á»£c tiáº¿n hÃ nh ngÆ°á»£c láº¡i vá»›i Holm. Ta sáº½ báº¯t Ä‘áº§u báº±ng kiá»ƒm Ä‘á»‹nh cÃ³ p.value Ã­t Ã½ nghÄ©a thá»‘ng kÃª nháº¥t, láº§n lÆ°á»£t thá»±c hiá»‡n kiá»ƒm Ä‘á»‹nh báº±ng cÃ¡ch so sÃ¡nh vá»›i $\alpha, \alpha/2, \alpha/3,\dots$ cho Ä‘áº¿n khi ta tÃ¬m Ä‘Æ°á»£c giÃ¡ trá»‹ cÃ³ Ã½ nghÄ©a thá»‘ng kÃª Ä‘áº§u tiÃªn. Ta káº¿t luáº­n ráº±ng nhá»¯ng kiá»ƒm Ä‘á»‹nh tÆ°Æ¡ng á»©ng vá»›i cÃ¡c p.value cÃ²n láº¡i cÃ³ Ã½ nghÄ©a thá»‘ng kÃª. trong thá»±c hÃ nh, phÆ°Æ¡ng phÃ¡p nÃ y tá» ra khÃ¡ hiá»‡u quáº£ so vá»›i Holm. Cáº£ 2 phÆ°Æ¡ng phÃ¡p cÃ³ thá»ƒ khÃ´ng mang láº¡i cÃ¹ng 1 vá»‹ trÃ­ dá»«ng. 

Nháº¯c láº¡i ráº±ng má»™t khi sá»‘ lÆ°á»£ng kiá»ƒm Ä‘á»‹nh tÄƒng thÃ¬ cÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘iá»u chá»‰nh FWER sáº½ khÃ´ng cÃ²n nháº¡y Ä‘á»ƒ phÃ¡t hiá»‡n cÃ¡c false positive. NhÆ° váº­y, má»™t "idea" má»›i Ä‘Æ°á»£c hÃ¬nh thÃ nh nháº±m giáº£i quyáº¿t váº¥n Ä‘á» cÃ²n láº¡i Ä‘Ã³ lÃ  _False Discovery Rate_.

# False Discovery Rate (FDR)

Khi ta Ä‘iá»u chá»‰nh FWER, ta thÆ°á»ng tháº¥y ráº±ng giÃ¡ trá»‹ $\alpha$ sau Ä‘iá»u chá»‰nh váº«n ráº¥t nhá», Ä‘iá»u nÃ y lÃ m cho kháº£ nÄƒng phÃ¡t hiá»‡n false positive trá»Ÿ nÃªn yáº¿u hÆ¡n. VÃ  ta thÆ°á»ng sáº½ fail to reject cáº£ giáº£ thuyáº¿t $H_o$ Ä‘Ãºng vÃ  giáº£ thuyáº¿t $H_o$ sai. VÃ¬ tháº¿ ta cáº§n pháº£i xem xÃ©t vÃ  Ä‘iá»u chá»‰nh sá»‘ lÆ°á»£ng kiá»ƒm Ä‘á»‹nh bá»‹ rejected sai trÃªn tá»•ng sá»‘ cÃ¡c kiá»ƒm Ä‘á»‹nh Ä‘Ã£ bá»‹ rejected. "idea" nÃ y khÃ¡c vá»›i idea cá»§a FWER, trong khi Ä‘iá»u chá»‰nh FWER ta sáº½ quan tÃ¢m tá»›i sá»‘ lÆ°á»£ng kiá»ƒm Ä‘á»‹nh bá»‹ reject sai trÃªn tá»•ng sá»‘ cÃ¡c kiá»ƒm Ä‘á»‹nh, trong khi Ä‘iá»u chá»‰nh FDR chÃ­nh lÃ  


$$
FDR = \cases{\E(\frac{V}{R}) = \frac{\text{Number of false rejections}}{\text{total number of rejections}}, R> 0 \\
0, R=0},
$$
Vá»›i FDR ta sáº½ reject nhiá»u false positive hÆ¡n. NgoÃ i ra ta cÅ©ng cÃ³ thá»ƒ chá»©ng minh Ä‘Æ°á»£c má»‘i quan há»‡ cá»§a FWER vÃ  FDR. Ta chia lÃ m 2 trÆ°á»ng há»£p nhÆ° sau: 

__Case 1: khi $V=R$__, theo Ä‘á»‹nh nghÄ©a ta cÃ³ 

$$
\frac{V}{R} = \cases{
0, \text{ if } V = 0\\
1 \text{ if } V\ge 1
}
$$
nhÆ° váº­y

$$
\begin{split}
FDR = \E(V/R) &= \E(V/R|V=0)\P(V=0) + \E(V/R|V\ge 1)\P(V\ge 1)\\
&= 0\P(V=0) + 1\P(V \ge 1)\\
&=\P(V \ge 1) \\
&= FWER
\end{split}
$$

__Case 2: $V< R$__

$$
\begin{split}
FDR = \E(V/R) &= \E(V/R|V \ge 1)\P(V \ge 1) + \E(V/R|V=0)\P(V=0) \\
&= \E(V/R|V \ge1)\P(V \ge 1)+0 \\
&< 1.\P(V \ge 1) \\
&= FWER
\end{split}
$$

VÃ¬ $FDR \le FWER$ nÃªn Ä‘á»™ nháº¡y cá»§a FDR trong viá»‡c phÃ¡ hiá»‡n false positive luÃ´n cao hÆ¡n. 

Má»™t trong nhá»¯ng phÆ°Æ¡ng phÃ¡p cho phÃ©p Ä‘iá»u chá»‰nh FDR lÃ  _Benjamini and Hochberg_ (BH). PhÆ°Æ¡ng phÃ¡p Ä‘Æ°á»£c tiáº¿n hÃ nh nhÆ° sau

1. Sáº¯p xáº¿p cÃ¡c p-values tá»« nhá» tá»›i lá»›n, ta cÃ³ $p_{(1)} \le p_{(1)} \le \dots \le p_{(m)}$
2. cho má»—i giÃ¡ trá»‹ $j = m, \dots, 1:$ ta kiá»ƒm Ä‘á»‹nh
   - If $p_{(j)} \ge \frac{j}{m}\alpha$, fail to reject $H_{0j}$ and continue
   - Otherwise, reject $H_{0(j)},\dots,H_{0(1)}$.
   
Sá»­ dá»¥ng cÃ¹ng má»™t sá»‘ liá»‡u nhÆ° trÃªn ta cÃ³
   
```{r}

mutate(d,p.adj = p*n()/rank(p))%>%
  filter(p.adj<=0.05)%>%
  select(type, p.adj)%>%
  modify_if(is.numeric, round, digits = 3)%>%
  draw_table()
```

```{r}
d%<>%
  mutate(BH = p.adjust(p,"BH"))

draw_table(modify_if(d,is.numeric, round, digits = 3))

mutate(d, decision = ifelse(BH<=0.05,"reject"," fail to reject"), x = (1:n())/n() )%>%
  ggplot(aes(x =x , y = p, color = decision ))+
  geom_point()+
  geom_abline(slope = 0.05, intercept = 0)

```

Káº¿t quáº£ tÆ°Æ¡ng tá»±. 

Ta cÃ³ thá»ƒ Ä‘Æ°a ra vÃ i nháº­n xÃ©t nhÆ° sau

- Bá»Ÿi vÃ¬ ta Ä‘iá»u chá»‰nh FDR táº¡i 0.05 nÃªn ta cÃ³ thá»ƒ káº¿t luáº­n ráº±ng trung bÃ¬nh thÃ¬ 5% trong sá»‘ 2 kiá»ƒm Ä‘á»‹nh bá»‹ rejected sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n sai $0.05*2 = 0.1$. 

- Using Bonferroni method we will obtain 2 rejected hypotheses as follows
- Náº¿u ta chá»n $\alpha =0.1$ thÃ¬ phÆ°Æ¡ng phÃ¡p BH cho 3 kiá»ƒm Ä‘á»‹nh bá»‹ rejected, trong khi nhá»¯ng phÆ°Æ¡ng phÃ¡p Ä‘iá»u chá»‰nh FWER thÃ¬ cho 2 kiá»ƒm Ä‘á»‹nh bá»‹ rejected. NhÆ° váº­y rÃµ rÃ ng FDR nháº¡y hÆ¡n so vá»›i FWER (xem hÃ¬nh dÆ°á»›i)

```{r, echo=F}
draw_table(d%>% modify_if(is.numeric,round, digits = 3))
```

# Káº¿t luáº­n

- Vá»›i FWER, PhÆ°Æ¡ng phÃ¡p stepwise tráº£ láº¡i cÃ¡c giÃ¡ trá»‹ adjusted p-values nhÃµ hÆ¡n so vá»›i single-step. NghÄ©a lÃ  stepwise cÃ³ Ä‘á»™ nháº¡y tá»‘t hÆ¡n single step trong viá»‡c phÃ¡t hiá»‡n false positive.  Cá»¥ng chÃº Ã½ ráº±ng cÃ ng nhiá»u kiá»ƒm Ä‘á»‹nh thÃ¬ Ä‘á»™ nháº¡y cÃ ng giáº£m.
- Vá»›i FDR, Ta fail to reject cÃ ng nhiá»u null hypothesis thÃ¬ Ä‘á»™ nháº¡y cÃ ng giáº£m. 
- Ta cÃ³ thá»ƒ Ä‘iá»u chá»‰nh Ä‘á»ƒ cáº£i tiáº¿n Ä‘á»™ nháº¡y nhÆ°ng má»™t khi sá»‘ lÆ°á»£ng kiá»ƒm Ä‘á»‹nh khÃ´ng cÃ³ Ã½ nghÄ©a cÃ ng nhiá»u thÃ¬ kháº£ nÄƒng cáº£i tiáº¿n cÃ ng tháº¥p. 







































































<!-- ################################################################################################### -->
<!-- :::: {.blackbox data-latex=""} -->
<!-- ::: {.center data-latex=""} -->
<!-- **Proof:** -->
<!-- ::: -->
<!-- over here -->
<!-- :::: -->

<!-- notation on equal sign -->
<!-- \stackrel{}{} -->
