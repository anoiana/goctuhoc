---
title: "MÃ´ HiÌ€nh Cho Data RÆ¡Ì€i RaÌ£c"
author: ğŸ‘¦ğŸ» $\mathcal{An}$
date: "&#x1F4C5; _`r {
if(!file.exists('date_list.rds')){saveRDS(list(), file = 'date_list.rds')}
update=FALSE
filename=knitr::current_input(dir = FALSE)
mylist <- readRDS(file ='date_list.rds')
if(update|!(filename%in%names(mylist))){
mylist[[filename]]<- format(Sys.Date(),format = '%d-%m-%Y')
saveRDS(mylist, file = 'date_list.rds')}
readRDS(file ='date_list.rds')[[filename]]  }`_"
abstract: |
output: 
    bookdown::html_document2:
      fig_caption: yes
      theme: default
      toc: true
      toc_float: 
        collapsed: false
      toc_depth: 3
      code_folding: hide
      css: "../00_supp/style.css"
      number_sections: true
      includes:
        in_header: ["../00_supp/header.html"]
        before_body: "before_body.html"
        after_body: "../00_supp/mycomment.html"
fontsize: 12pt
bibliography: ["citation.bib"]
csl: "../00_supp/apa.csl"
link-citations: true
---

```{=tex}
\def\emp{\varnothing}
\usepackage{extarrows}
```


```{css, echo = F}
/*----------LOGO above TOC---------*/

#TOC::before {
  content: "";
  display: block;
  height: 200px;
  margin: 2.75em 20px 40px 20px;
  background-image: url("machine-learning.jpg");
  background-size: contain;
  background-position: center center;
  background-repeat: no-repeat;
}
```

::: {.watermark}
*DRAFT*
:::

```{r child="../00_supp/general_rmd.Rmd"}
```




`r rs('_[Tham kháº£o táº¡i @mur2012]_')`

## Giá»›i thiá»‡u

::: {.blackbox}
Giáº£ sá»­ ta cÃ³ má»™t data bao gá»“m cÃ¡c $(y_i,\bf{x}_i)_{i=1}^n$, trong Ä‘Ã³ $y \in \{0,1\}$ lÃ  biáº¿n target nhá»‹ phÃ¢n cÃ²n $\bf{x}$ lÃ  táº­p há»£p cÃ¡c biáº¿n feature cá»§a observation $i$. Má»¥c tiÃªu cá»§a ta lÃ  tá»« má»™t $\bf{x}_i$ cho trÆ°á»›c ta sáº½ xáº¿p obs. nÃ y vÃ o má»™t trong hai nhÃ³m nhá»‹ phÃ¢n $0$ hoáº·c $1$. Má»™t trong nhá»¯ng phÆ°Æ¡ng phÃ¡p giÃºp giáº£i quyáº¿t bÃ i toÃ¡n phÃ¢n loáº¡i nÃ y chÃ­nh lÃ  sá»­ dá»¥ng model Bayes. Ta sáº½ nháº¯c láº¡i cÃ´ng thá»©c cá»§a Bayes nhÆ° sau
$$
p(y=c|\bf{x},\bf{\theta}) \propto p(\bf{x}|y=c,\bf{\theta})p(y=c|\bf{\theta}).
(\#eq:eq1)
$$

Äá»ƒ sá»­ dá»¥ng model Bayes nhÆ° trÃªn ta cáº§n xÃ¡c Ä‘á»‹nh hÃ¬nh dáº¡ng cá»§a $p(\bf{x}|y=c,\bf{\theta})$. CÃ³ nghÄ©a lÃ  ta pháº£i xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c trong má»—i má»™t phÃ¢n nhÃ³m $c$, thÃ¬ kiá»ƒu data ta mong muá»‘n lÃ  gÃ¬.
:::

## Há»c Bayes

Giáº£ sá»­ ta cÃ³ má»™t dÃ£y sá»‘ $\mathcal{D} = \{1,2,\dots,100\}$. Náº¿u nhÆ° thÃ´ng tin ta cÃ³ lÃ  *"sá»‘ $16$ lÃ  má»™t sá»‘ dÆ°Æ¡ng"*, náº¿u dá»±a vÃ o thÃ´ng tin nÃ y liá»‡u ta cÃ³ thá»ƒ káº¿t luáº­n cÃ¡c sá»‘ khÃ¡c nhÆ° $17,6,32,99$ cÅ©ng lÃ  sá»‘ dÆ°Æ¡ng hay khÃ´ng? Bá»Ÿi vÃ¬ thÃ´ng tin ta cÃ³ Ä‘Æ°á»£c quÃ¡ Ã­t, nÃªn cÃ³ thá»ƒ káº¿t quáº£ dá»± Ä‘oÃ¡n sáº½ cÃ³ Ä‘á»™ tin cáº­y ráº¥t tháº¥p. Náº¿u nhÆ° con sá»‘ Ä‘Æ°á»£c dá»± Ä‘oÃ¡n cÃ³ Ä‘iá»ƒm tÆ°Æ¡ng Ä‘á»“ng vá»›i sá»‘ $16$, thÃ¬ kháº£ nÄƒng dá»± Ä‘oÃ¡n sáº½ kháº£ quan hÆ¡n. NhÆ°ng tÆ°Æ¡ng Ä‘á»“ng á»Ÿ khÃ­a cáº¡nh nÃ o? vÃ­ dá»¥ sá»‘ $17$ cÃ³ Ä‘iá»ƒm tÆ°Æ¡ng Ä‘á»“ng vÃ¬ nÃ³ Ä‘á»©ng gáº§n vá»›i sá»‘ $16$ hÆ¡n cÃ¡c sá»‘ cÃ²n láº¡i, hoáº·c lÃ  sá»‘ $6$ thÃ¬ cÃ³ Ä‘iá»ƒm tÆ°Æ¡ng Ä‘á»“ng lÃ  nÃ³ trÃ¹ng vá»›i chá»¯ sá»‘ cuá»‘i cá»§a sá»‘ $16$. NgoÃ i ra sá»‘ $32$ cÅ©ng cÃ³ Ä‘iá»ƒm tÆ°Æ¡ng Ä‘á»“ng vá»›i $16$ vÃ¬ cáº£ hai sá»‘ Ä‘iá»u cÃ³ thá»ƒ viáº¿t dÆ°á»›i dáº¡ng lÅ©y thá»«a cÆ¡ sá»‘ 2 $(16=2^4, 32 = 2^5)$. Tuy nhiÃªn sá»‘ $99$ láº¡i khÃ´ng cÃ³ Ä‘iá»ƒm chung vá»›i sá»‘ $16$. Gá»i $\tilde{x} \in \{1,\dots100\}$ lÃ  con sá»‘ ta cáº§n dá»± Ä‘oÃ¡n, ta sáº½ cáº§n tÃ­nh $p(\tilde{x}|\mathcal{D})$ chÃ­nh lÃ  xÃ¡c suáº¥t cá»§a $\tilde{x} \in C$, $C \in \{\text{dÆ°Æ¡ng, khÃ´ng dÆ°Æ¡ng}\}$, biáº¿t ráº±ng $\mathcal{D}$. xÃ¡c suáº¥t nÃ y Ä‘Æ°á»£c gá»i lÃ  **posterior predictive distribution**. NhÆ° váº­y Ä‘á»ƒ dá»± Ä‘oÃ¡n má»™t sá»‘ $\tilde{x}$, ta cáº§n xem xÃ©t Ä‘á»™ giá»‘ng nhau cá»§a nÃ³ vá»›i sá»‘ $16$, vÃ  tÃ¹y thuá»™c vÃ o khÃ­a cáº¡nh tÆ°Æ¡ng Ä‘á»“ng mÃ  ta xem xÃ©t sáº½ cho ra káº¿t quáº£ mÃ  ta mong muá»‘n. 

BÃ¢y giá» ta láº¡i Ä‘Æ°á»£c cung cáº¥p thÃªm thÃ´ng tin ráº±ng cÃ¡c sá»‘ $8,2,64$ cÅ©ng lÃ  cÃ¡c sá»‘ dÆ°Æ¡ng. NhÆ° váº­y ta cÃ³ thá»ƒ suy Ä‘oÃ¡n ráº±ng má»‘i tÆ°Æ¡ng quan ráº¥t cÃ³ thá»ƒ lÃ  *"lÅ©y thá»«a cÆ¡ sá»‘ 2"*. Tuy nhiÃªn náº¿u ta biáº¿t ráº±ng $\mathcal{D} = \{16,23,19,20\}$ thÃ¬ má»‘i tÆ°Æ¡ng quan sáº½ thuá»™c má»™t ná»™i dung khÃ¡c chá»© khÃ´ng lÃ  lÅ©y thá»«a cÆ¡ sá»‘ 2 ná»¯a. 

Äá»ƒ biá»ƒu hiá»‡n nhá»¯ng Ä‘áº·c tÃ­nh nÃ y trong má»™t machine thÃ¬ phÆ°Æ¡ng phÃ¡p cá»• Ä‘iá»ƒn chÃ­nh lÃ  giáº£ sá»­ sá»± tá»“n táº¡i cá»§a má»™t táº­p há»£p $\mathcal{H}$ chá»©a cÃ¡c Ä‘áº·c tÃ­nh tÆ°Æ¡ng Ä‘á»“ng nhÆ° sá»‘ cháºµn, sá»‘ láº½, táº¥t cáº£ cÃ¡c sá»‘ tá»« 1 tá»›i 100, lÅ©y thá»«a cÆ¡ sá»‘ 2, nhá»¯ng sá»‘ cÃ³ sá»‘ cuá»‘i lÃ  $j$ ($0 \le j\le 9$). Má»™t táº­p há»£p con cá»§a $\mathcal{H}$ chá»©a nhiá»u cÃ¡c Ä‘áº·c tÃ­nh tÆ°Æ¡ng Ä‘á»“ng vá»›i data $D$ nháº¥t Ä‘Æ°á»£c gá»i lÃ  **version space**. 

Tuy nhiÃªn ta cáº§n biáº¿t ráº±ng version space chá»‰ lÃ  má»™t táº­p con cá»§a $\mathcal{H}$, nÃ³ khÃ´ng mang Ä‘áº§y Ä‘á»§ cÃ¡c thÃ´ng tin, mÃ  nÃ³ chá»‰ pháº£n Ã¡nh thÃ´ng tin tá»« data $D$. Quay ngÆ°á»£c láº¡i vÃ­ dá»¥ ban Ä‘áº§u náº¿u ta quan sÃ¡t $\mathcal{D} = \{16\}$, thÃ¬ ta sáº½ ráº¥t khÃ³ Ä‘á»ƒ dá»± Ä‘oÃ¡n má»™t sá»‘ $\tilde x$ nÃ o Ä‘Ã³, nhÆ°ng náº¿u ta quan sÃ¡t $\mathcal{D} = \{16,8,2,64\}$ thÃ¬ ta sáº½ ráº¥t dá»… nghiÃªng vá» má»‘i tÆ°Æ¡ng Ä‘á»“ng "lÅ©y thá»«a cÆ¡ sá»‘ 2". CÃ¡c thÃ´ng tin vá» má»‘i tÆ°Æ¡ng Ä‘á»“ng nÃ y cÃ³ thá»ƒ dá»… dÃ ng Ä‘Æ°á»£c hiá»ƒu thÃ´ng qua trÆ°á»ng phÃ¡i Bayes trong thá»‘ng kÃª. 

## Likelihood

Quay láº¡i vÃ­ dá»¥ á»Ÿ pháº§n trÆ°á»›c, náº¿u nhÆ° ta quan sÃ¡t Ä‘Æ°á»£c $\mathcal{D} = \{16,8,2,64\}$, táº¡i sao ta láº¡i chá»n má»‘i tÆ°Æ¡ng Ä‘á»“ng $h_{hai}:=$"lÅ©y thá»«a cÆ¡ sá»‘ 2" mÃ  khÃ´ng pháº£i $h_{cháºµn}:=$"sá»‘ cháºµn". Náº¿u nhÆ° má»‘i tÆ°Æ¡ng Ä‘á»“ng tháº­t sá»± cá»§a nÃ³ lÃ  $h_{cháºµn}$ mÃ  khÃ´ng pháº£i $h_{hai}$ thÃ¬ sao?

Äá»ƒ Ä‘Ã¡nh giÃ¡ Ä‘á»™ tin cáº­y cá»§a nhá»¯ng má»‘i tÆ°Æ¡ng Ä‘á»“ng nÃ y so vá»›i data ta Ä‘Ã£ quan sÃ¡t, ta sáº½ tÃ­nh xÃ¡c suáº¥t cá»§a $N$ quan sÃ¡t Ä‘á»™c láº­p nÃ y nhÆ° sau 
$$
p(\mathcal{D}|h) = \Big(\frac{1}{\text{size}(h)}\Big)^N =  \Big(\frac{1}{|h|}\Big)^N
(\#eq:eq2)
$$

`r lb(eq2)` Ä‘Æ°á»£c gá»i lÃ  **size principle**, nghÄ©a lÃ  giáº£ thuyáº¿t nÃ o gáº§n vá»›i data nháº¥t sáº½ cho ra xÃ¡c suáº¥t lá»›n nháº¥t. VÃ­ dá»¥ nhÆ° Ä‘á»‘i vá»›i $\mathcal{D} = \{16\}$ thÃ¬ ta cÃ³ $p(\mathcal{D}|h_{hai}) = 1/6$^[$2^k < 100 \Leftrightarrow k < 7$], cÃ²n $p(\mathcal{D}|h_{cháºµn}) = 1/50$. NhÆ° váº­y $p(\mathcal{D}|h_{hai}) > p(\mathcal{D}|h_{cháºµn})$, vÃ  sau khi ta quan sÃ¡t 4 dá»¯ liá»‡u ta cÃ³ 
$h_{hai} = (1/6)^{4} = 7.7\times 10^{-4}> h_{cháºµn} = (1/50)^{4} = 1.6\times10^{-7}$. RÃµ rÃ ng tá»‰ lá»‡ likelihood lÃ  $5000:1$ nghiÃªng vá» $h_{hai}$. 

## Prior

Ta quan sÃ¡t Ä‘Æ°á»£c $\mathcal{D} = \{16,8,2,64\}$



<!-- ################################################################################################### -->

------------------------------------------------------------------------

## ğŸ“ *References* {.unnumbered}

